<!DOCTYPE HTML>
<html>
<head>
    <title>Schooled</title>
</head>
<style>
    td{
        border: 1px solid black;
    }
    #WelcomeScreen{
        display: block;
    }
    #CreateGameScreen{
        display: none;
    }
    #JoinGameScreen{
        display: none;
    }
    #LobbyScreen{
        display: none;
    }
</style>
<script src="/socket.io/socket.io.js"></script>
<script>
var welcomeScreen;
var createGameScreen;
var joinGameScreen;
var lobbyScreen;
var currentScreen;
var socket;

function init(){
    welcomeScreen = document.getElementById('WelcomeScreen');
    createGameScreen = document.getElementById('CreateGameScreen');
    joinGameScreen = document.getElementById('JoinGameScreen');
    lobbyScreen = document.getElementById('LobbyScreen');
    currentScreen = welcomeScreen;
    initSocket();
}

function initSocket(){
    socket = io();
    socket.on('joinLobby', function(lobby){
        enterLobbyScreen(lobby);
    });
    
    socket.on('updateLobby', function(lobby){
        updateLobby(lobby);
    });
    
    socket.on('errorMessage', function(message){
        alert("Error: "+message);
    });
}

function changeScreen(newScreen){
    currentScreen.style.display = "none";
    newScreen.style.display = "block";
    currentScreen = newScreen;
}

function newGameRequest(){
    var nameBox = document.getElementById('NameBox');
    var name = nameBox.value;
    if(name.length == 0){
        alert("Please enter a name!")
    }
    else{
        socket.emit('newGameRequest', name);
    }
}

function joinGameRequest(){
    var nameBox = document.getElementById('NameBoxJoin');
    var name = nameBox.value;
    if(name.length == 0){
        alert("Please enter a name!")
    }
    else{
        var gameCodeBox = document.getElementById('GameCodeBox');
        var gameCode = gameCodeBox.value;
        if(gameCode.length != 6){
            alert("Please enter a valid six letter game code!")
        }
        else{
            socket.emit('joinGameRequest', {gameCode: gameCode.toUpperCase(), name: name});
        }
    }
}

function enterLobbyScreen(lobby){
    changeScreen(lobbyScreen);
    updateLobby(lobby);
}

function updateLobby(lobby){
    var gameCodeLabel = document.getElementById("GameCodeLabel");
    gameCodeLabel.innerHTML = "Game Code: "+lobby.gameCode;
    for(var playerIndex = 0; playerIndex < 4; playerIndex++){
        var playerLabel = document.getElementById("Player"+playerIndex+"Label");
        if(playerIndex < lobby.players.length){
            playerLabel.innerHTML = lobby.players[playerIndex];
        }
        else{
            playerLabel.innerHTML = "&nbsp;";
        }
    }
}

</script>
<body onload="init()">
    <center>
    <h1>Schooled</h1>
    <div id="WelcomeScreen">
        <button type="button" onclick="changeScreen(createGameScreen)">New Game</button>
        <button type="button" onclick="changeScreen(joinGameScreen)">Join Game</button>
    </div>
    <div id="CreateGameScreen">
        <input type="text" id="NameBox" placeholder="Enter your name"><br>
        <button type="button" onclick="newGameRequest()">Create Game</button>
        <button type="button" onclick="changeScreen(welcomeScreen)">Back</button>
    </div>
    <div id="JoinGameScreen">
        <input type="text" id="GameCodeBox" placeholder="Enter a game code"><br>
        <input type="text" id="NameBoxJoin" placeholder="Enter your name"><br>
        <button type="button" onclick="joinGameRequest()">Join Game</button>
        <button type="button" onclick="changeScreen(welcomeScreen)">Back</button>
    </div>
    <div id="LobbyScreen">
        <h2 id="GameCodeLabel">Game Code:</h2>
        <table>
            <tr><td id="Player0Label">&nbsp;</td></tr>
            <tr><td id="Player1Label">&nbsp;</td></tr>
            <tr><td id="Player2Label">&nbsp;</td></tr>
            <tr><td id="Player3Label">&nbsp;</td></tr>
        </table>
        <button type="button" onclick="alert('Started Game!')">Start Game</button>
        <button type="button" onclick="changeScreen(welcomeScreen)">Back</button>
    </div>
    </center>
</body>
</html>
